# Publishing Guide for react-native-langflow-chat

This guide will help you create and publish your npm package step by step.

## Project Structure

Create the following directory structure:

```
react-native-langflow-chat/
├── src/
│   ├── index.tsx
│   └── LangFlowChatWidget.tsx
├── lib/ (generated by TypeScript)
├── package.json
├── tsconfig.json
├── .eslintrc.js
├── .npmignore
├── README.md
├── LICENSE
└── .gitignore
```

## Step 1: Initialize the Project

```bash
# Create project directory
mkdir react-native-langflow-chat
cd react-native-langflow-chat

# Initialize npm package
npm init -y
```

## Step 2: Copy the Files

Copy all the files from the artifacts:
- `package.json` (replace the generated one)
- `tsconfig.json`
- `.eslintrc.js`
- `.npmignore`
- `LICENSE`
- `README.md`
- Create `src/` folder and add:
  - `src/index.tsx`
  - `src/LangFlowChatWidget.tsx`

## Step 3: Install Dependencies

```bash
# Install dev dependencies (for building the package)
npm install --save-dev \
  typescript \
  @types/react \
  @types/react-native \
  @typescript-eslint/eslint-plugin \
  @typescript-eslint/parser \
  eslint \
  eslint-plugin-react \
  eslint-plugin-react-hooks \
  eslint-plugin-react-native \
  rimraf \
  jest \
  react \
  react-native \
  react-native-webview

# Note: react, react-native, and react-native-webview are also installed as devDependencies
# for development, but they're defined as peerDependencies so users must install them
```

## Step 4: Update package.json

Update the `package.json` with your information:

```json
{
  "name": "react-native-langflow-chat",
  "author": "Your Name <your.email@example.com>",
  "repository": {
    "type": "git",
    "url": "https://github.com/yourusername/react-native-langflow-chat.git"
  },
  "bugs": {
    "url": "https://github.com/yourusername/react-native-langflow-chat/issues"
  },
  "homepage": "https://github.com/yourusername/react-native-langflow-chat#readme"
}
```

## Step 5: Create Git Repository

```bash
# Initialize git
git init

# Create .gitignore
cat > .gitignore << EOF
# Dependencies
node_modules/

# Build output
lib/

# Logs
*.log
npm-debug.log*
yarn-debug.log*

# Runtime data
pids
*.pid
*.seed

# Coverage directory used by tools like istanbul
coverage/

# Environment variables
.env
.env.local
.env.development.local
.env.test.local
.env.production.local

# IDE
.vscode/
.idea/

# OS generated files
.DS_Store
.DS_Store?
._*
.Spotlight-V100
.Trashes
ehthumbs.db
Thumbs.db
EOF

# Add and commit files
git add .
git commit -m "Initial commit"

# Add remote origin (create GitHub repo first)
git remote add origin https://github.com/yourusername/react-native-langflow-chat.git
git push -u origin main
```

## Step 6: Build the Package

```bash
# Clean and build
npm run clean
npm run build

# Verify the build created lib/ directory with compiled files
ls lib/
```

## Step 7: Test Locally

Create a test React Native project to test your package:

```bash
# In another directory
npx react-native init TestLangflowChat
cd TestLangflowChat

# Install react-native-webview
npm install react-native-webview

# Install your local package
npm install /path/to/react-native-langflow-chat

# Test the import in App.js
```

Test App.js:
```javascript
import React from 'react';
import { View } from 'react-native';
import { LangFlowChatWidget } from 'react-native-langflow-chat';

const App = () => {
  return (
    <View style={{ flex: 1 }}>
      <LangFlowChatWidget
        flowId="test-flow-id"
        hostUrl="https://your-test-server.com"
        onLoad={() => console.log('Widget loaded')}
        onError={(error) => console.error('Error:', error)}
      />
    </View>
  );
};

export default App;
```

## Step 8: Prepare for Publishing

### Login to NPM

```bash
# Login to npm (create account at npmjs.com first)
npm login
```

### Check Package Name Availability

```bash
# Check if package name is available
npm view react-native-langflow-chat

# If it exists, you'll need to choose a different name like:
# - @yourusername/react-native-langflow-chat
# - react-native-langflow-chat-widget
# - rn-langflow-chat
```

### Version Management

```bash
# For initial release
npm version 1.0.0

# For future updates:
# npm version patch  # 1.0.0 -> 1.0.1
# npm version minor  # 1.0.0 -> 1.1.0  
# npm version major  # 1.0.0 -> 2.0.0
```

## Step 9: Publish

### Dry Run First

```bash
# Test what would be published
npm pack

# This creates a .tgz file showing exactly what will be published
# Extract and check contents:
tar -tzf react-native-langflow-chat-1.0.0.tgz
```

### Publish to NPM

```bash
# Publish to npm
npm publish

# For scoped packages (if using @yourusername/package-name):
npm publish --access public
```

## Step 10: Usage in Your Project

After publishing, users need to install both your package AND the peer dependencies:

```bash
# Users must install both packages
npm install react-native-langflow-chat react-native-webview

# For iOS, they also need to run:
cd ios && pod install
```

**Important**: `react-native-webview` is a **peer dependency**, which means:
- ✅ **Correct**: It's listed in `peerDependencies` so users must install it themselves
- ✅ **Why**: This prevents version conflicts and reduces bundle size
- ✅ **User Control**: Users can choose their preferred version of react-native-webview

Usage (JavaScript):
```javascript
import React from 'react';
import { View } from 'react-native';
import { LangFlowChatWidget } from 'react-native-langflow-chat';

const ChatScreen = () => {
  const handleMessage = (message) => {
    console.log('New message:', message);
  };

  const handleError = (error) => {
    console.error('Chat error:', error);
  };

  return (
    <View style={{ flex: 1 }}>
      <LangFlowChatWidget
        flowId="your-actual-flow-id"
        hostUrl="https://your-langflow-server.com"
        apiKey="your-api-key"
        windowTitle="AI Assistant"
        onMessage={handleMessage}
        onError={handleError}
        onLoad={() => console.log('Chat loaded!')}
        botMessageStyle={{
          backgroundColor: "#f3f4f6",
          borderRadius: "16px 16px 16px 4px",
          padding: "12px 16px"
        }}
        userMessageStyle={{
          backgroundColor: "#3b82f6",
          color: "#ffffff",
          borderRadius: "16px 16px 4px 16px",
          padding: "12px 16px"
        }}
      />
    </View>
  );
};

export default ChatScreen;
```

## Step 11: Maintenance

### Updating the Package

```bash
# Make changes to src/
# Build
npm run build

# Update version
npm version patch

# Publish update
npm publish

# Push changes to git
git push origin main --tags
```

### Adding Features

1. Add features to `src/LangFlowChatWidget.tsx`
2. Update type definitions in `src/index.tsx`
3. Update README.md with new features
4. Build and test locally
5. Update version and publish

## Troubleshooting

### Common Issues:

1. **Package name already exists**: Choose a different name or use scoped package
2. **TypeScript errors**: Ensure all types are properly defined
3. **Build fails**: Check tsconfig.json configuration
4. **Import errors**: Verify export statements in src/index.tsx
5. **WebView issues**: Ensure react-native-webview is listed as peer dependency

### Debug Publishing:

```bash
# Check what files will be included
npm pack --dry-run

# Check package info
npm view your-package-name

# Check installed package contents
npm ls react-native-langflow-chat
```

## Alternative Package Names

If `react-native-langflow-chat` is taken, consider:
- `@yourusername/react-native-langflow-chat`
- `react-native-langflow-widget`
- `rn-langflow-chat`
- `langflow-chat-rn`
- `react-native-langflow-webview`

Remember to update all references in README.md and package.json if you change the name!